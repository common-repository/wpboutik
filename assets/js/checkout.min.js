jQuery(document).ready(function(p){function e(e){var a;window.location.search&&(a=new URLSearchParams(window.location.search)).has(e)&&(a.delete(e),e=window.location.protocol+"//"+window.location.host+window.location.pathname+"?"+a.toString(),window.history.replaceState({path:e},"",e))}function a(e,a){if(window.location.search){var t=new URLSearchParams(window.location.search);if(t.has(e)&&t.get(e)===a)return 1}}function _(e){e?(document.querySelector("#card-button").disabled=!0,document.querySelector("#spinner").classList.remove("hidden")):(document.querySelector("#card-button").disabled=!1,document.querySelector("#spinner").classList.add("hidden"))}function t(a=!1){var e=p("#shipping_country").val(),t=p("#shipping_city").val(),o=p("#shipping_postal_code").val(),i=p("#shipping_address").val(),n=p("#shipping_company").val();e&&t&&o&&i?p.ajax({type:"post",url:ajax_var_checkout.url,data:{action:"wpboutik_ajax_checkout_boxtal_load_price_offers",pays:e,ville:t,cp:o,adresse:i,type:n?"entreprise":"particulier",nonce:ajax_var_checkout.nonce_boxtal},success:function(e){e.success&&(p.each(e.data,function(e,a){p("#delivery-method-"+e+"-flat-rate").html(a.flat_rate),p("input[name=flat_rate_"+e+"]").val(a.flat_rate_without_symbol),p("#delivery-method-"+e+"-boxtal").html(a.html),"0&euro;"==a.flat_rate?p("#delivery-method-"+e+"-flat-rate").closest("label").fadeOut():p("#delivery-method-"+e+"-flat-rate").closest("label").fadeIn()}),p("#deliversmethod").show(),a)&&setTimeout(function(){p("input[type=radio][name=delivery-method]:last").click()},500)}}):p("#deliversmethod").hide()}a("payment_mollie_status","cancelled")&&(p("#payment-error").hasClass("hidden")&&p("#payment-error").removeClass("hidden"),e("payment_mollie_status")),a("payment_paybox_status","cancelled")&&(p("#payment-error").hasClass("hidden")&&p("#payment-error").removeClass("hidden"),e("payment_paybox_status")),p("#already_customer").change(function(){p("#formlogin_checkout").hasClass("hidden")?p("#formlogin_checkout").removeClass("hidden"):p("#formlogin_checkout").addClass("hidden")}),p("#has_coupon_code").change(function(){p("#formcoupon_checkout").hasClass("hidden")?p("#formcoupon_checkout").removeClass("hidden"):p("#formcoupon_checkout").addClass("hidden")}),p("#has_gift_card_code").change(function(){p("#formgift_card_checkout").hasClass("hidden")?p("#formgift_card_checkout").removeClass("hidden"):p("#formgift_card_checkout").addClass("hidden")}),p("#cardstripe").hide(),p("#paypaldiv").hide(),p("#bacsdiv").hide(),p("#cardmollie").hide(),p("#card").is(":checked")&&p("#cardstripe").show(),p("#paypal").is(":checked")&&p("#paypaldiv").show(),p("#bacs").is(":checked")&&p("#bacsdiv").show(),p("#mollie").is(":checked")&&p("#cardmollie").show(),p("input[type=radio][name=payment-type]").change(function(){var e;"free"==p(".create_order").attr("data-wpbcheckout")?(p("#paypaldiv").hide(),p("#bacsdiv").hide(),p("#cardstripe").hide(),p("#card-button").show(),p("#cardmollie").hide()):"paypal"==(e=p(this).attr("id"))?(p("#paypaldiv").show(),p("#bacsdiv").hide(),p("#cardstripe").hide(),p("#card-button").hide(),p("#cardmollie").hide()):"bacs"==e?(p("#bacsdiv").show(),p("#cardstripe").hide(),p("#paypaldiv").hide(),p("#card-button").show(),p("#cardmollie").hide()):"mollie"==e&&(p("#bacsdiv").hide(),p("#cardstripe").hide(),p("#paypaldiv").hide(),p("#card-button").show(),p("#cardmollie").show())}),p("#same-as-shipping").change(function(){p("#billingform").hasClass("hidden")?p("#billingform").removeClass("hidden"):p("#billingform").addClass("hidden")}),0<ajax_var_checkout.carriers_boxtal.length&&(t(!0),p("#shipping_country, #shipping_city, #shipping_postal_code, #shipping_address").on("input",function(){t()})),p(document).on("click",".remove-promo",function(e){e.preventDefault();e={action:"wpboutik_remove_promo",nonce:ajax_var_checkout.nonce_promo};if(p(this).hasClass("coupon"))e.delete_promo="coupon";else{if(!p(this).hasClass("gift_card"))return!1;e.delete_promo="gift_card"}p.ajax({type:"post",url:ajax_var_checkout.url,data:e,dataType:"json",success:function(e){e.status&&location.reload()}})}),p(document).on("click",".openModalMethod",function(e){e.preventDefault();e=p(this).data("method-id");p("#myModal"+e).removeClass("hidden"),p.ajax({type:"post",url:ajax_var_checkout.url,data:{action:"wpboutik_ajax_checkout_boxtal_load_listpoints",pays:p("#shipping_country").val(),ville:p("#shipping_city").val(),cp:p("#shipping_postal_code").val(),adresse:p("#shipping_address").val(),operator_code:p(this).data("operator-code"),operator_logo:p(this).data("operator-logo"),method_id:e,flat_rate:p("#delivery-method-"+e+"-flat-rate").html(),nonce:p(this).data("nonce")},success:function(e){e.success&&p(".content_modal_boxtal_"+e.data.method_id).html(e.data.html)}})}),p(document).on("click",".chooseCodePoint",function(){var e=p(this).data("code-point"),a=p(this).data("name-point"),t=p(this).data("address-point"),o=p(this).data("city-point"),i=p(this).data("method-id"),n=p('.replacedButton[data-method-id="'+i+'"]'),n=(0<n.length?n.html('<div class="replacedButton" data-method-id="'+i+'"><p>'+a+" - "+t+" - "+o+'</p><a data-method-id="'+i+'" href="#" class="openModalMethod text-[var(--backgroundcolor)] underline focus:outline-none">Changer de point relais</a></div>'):p('.openModalMethod[data-method-id="'+i+'"]').replaceWith('<div class="replacedButton" data-method-id="'+i+'"><p>'+a+" - "+t+" - "+o+'</p><a data-method-id="'+i+'" href="#" class="openModalMethod text-[var(--backgroundcolor)] underline focus:outline-none">Changer de point relais</a></div>'),p("#myModal"+i).addClass("hidden"),p('input[type=radio][name="delivery-method"][value="'+i+'"]'));n.click(),n.after('<input type="hidden" name="code_point_'+i+'" value="'+e+'">'),n.after('<input type="hidden" name="address_point_'+i+'" value="'+a+" - "+t+" - "+o+'">')}),p(document).on("click",".closeModalMethod",function(){var e=p(this).data("method-id");p("#myModal"+e).addClass("hidden")}),p(".deliverymethod").mouseover(function(){p(this).addClass("ring-2 ring-[var(--backgroundcolor)]"),p(this).find(".span").addClass("border"),p(this).find(".span").removeClass("border-2")}).mouseout(function(){p(this).children("input").is(":checked")||(p(this).removeClass("ring-2 ring-[var(--backgroundcolor)]"),p(this).find(".span").addClass("border-2"),p(this).find(".span").removeClass("border"))}),p("#shipping_country").change(function(){p.ajax({type:"post",url:ajax_var_checkout.url,data:{action:"wpboutik_ajax_checkout_modify_tax_rate",payment_type:p("input[type=radio][name=payment-type]:checked").attr("id"),shipping_country_key:p(this).val(),shipping_postal_code:p("#shipping_postal_code").val(),shipping_city:p("#shipping_city").val(),shipping_company:p("#shipping_company").val(),shipping_address:p("#shipping_address").val(),method_shipping_id:p("input[type=radio][name=delivery-method]:checked").val(),nonce:p(this).data("nonce")},success:function(e){if(e.success){var a,t=e.tax;if(0!=t.length)for(var o in t)t.hasOwnProperty(o)&&(a=t[o],p("#tax_name_"+o).html("("+a.name+")"),p("#tax_"+o).html(a.value));else p("#tax_name_standard").html("()"),p("#tax_standard").html(0),p("#tax_name_reduce").html("()"),p("#tax_reduce").html(0),p("#tax_name_zero").html("()"),p("#tax_zero").html(0);p("#ordertotal").html(e.ordertotal),p("#paypal-button-container").attr("data-total",e.ordertotal)}}})}),p("input[type=radio][name=delivery-method]").change(function(){p.ajax({type:"post",url:ajax_var_checkout.url,data:{action:"wpboutik_ajax_checkout_add_price_delivery_method",payment_type:p("input[type=radio][name=payment-type]:checked").attr("id"),method_id:p(this).val(),shipping_country_key:p("#shipping_country").val(),shipping_country:p("#shipping_country").val(),shipping_postal_code:p("#shipping_postal_code").val(),shipping_city:p("#shipping_city").val(),shipping_company:p("#shipping_company").val(),shipping_address:p("#shipping_address").val(),nonce:p(this).data("nonce")},success:function(e){if(e.success){var a,t=e.tax;if(0!=t.length)for(var o in t)t.hasOwnProperty(o)&&(a=t[o],p("#tax_name_"+o).html("("+a.name+")"),p("#tax_"+o).html(a.value));else p("#tax_name_standard").html("()"),p("#tax_standard").html(0),p("#tax_name_reduce").html("()"),p("#tax_reduce").html(0),p("#tax_name_zero").html("()"),p("#tax_zero").html(0);p("#method_flat_rate").html(e.method_flat_rate),p("#ordertotal").html(e.ordertotal),p("#paypal-button-container").attr("data-total",e.ordertotal)}}})}),p("input[type=radio][name=delivery-method]").click(function(){p("input[type=radio][name=delivery-method]:not(:checked)").closest(".deliverymethod").find(".icon").addClass("hidden"),p("input[type=radio][name=delivery-method]:not(:checked)").closest(".deliverymethod").removeClass("ring-2 ring-[var(--backgroundcolor)]"),p(this).is(":checked")?(p(this).addClass("border-transparent"),p(this).removeClass("border-gray-300"),p(this).closest(".deliverymethod").children(".icon").removeClass("hidden"),p(this).closest(".deliverymethod").children(".span").removeClass("border-transparent"),p(this).closest(".deliverymethod").children(".span").addClass("border"),p(this).closest(".deliverymethod").children(".span").addClass("border-[var(--backgroundcolor)]"),p(this).closest(".deliverymethod").addClass("ring-2 ring-[var(--backgroundcolor)]")):(p(this).removeClass("border-transparent"),p(this).addClass("border-gray-300"),p(this).closest(".deliverymethod").children(".icon").addClass("hidden"),p(this).closest(".deliverymethod").children(".span").addClass("border-transparent"),p(this).closest(".deliverymethod").children(".span").removeClass("border"),p(this).closest(".deliverymethod").children(".span").removeClass("border-[var(--backgroundcolor)]"),p(this).closest(".deliverymethod").removeClass("ring-2 ring-[var(--backgroundcolor)]"))}),p(".wpbapplycouponcode").on("click",function(e){$thisbutton=p(this),nonce=$thisbutton.data("nonce");var a={action:"wpboutik_ajax_apply_coupon_code",coupon_code:p("input[name=coupon_code]").val(),nonce:nonce};p.ajax({type:"post",url:ajax_var_checkout.url,data:a,success:function(e){window.location=e.url}})}),p(".wpb_apply_gift_card_code").on("click",function(e){$thisbutton=p(this),nonce=$thisbutton.data("nonce");var a={action:"wpboutik_ajax_apply_gift_card_code",coupon_code:p("input[name=gift_card_code]").val(),nonce:nonce};p.ajax({type:"post",url:ajax_var_checkout.url,data:a,success:function(e){window.location=e.url}})}),p(".create_order").on("click",function(e){if("bacs"===p("input[type=radio][name=payment-type]:checked").attr("id")||"monetico"===p("input[type=radio][name=payment-type]:checked").attr("id")||"paybox"===p("input[type=radio][name=payment-type]:checked").attr("id")||p(this).attr("data-wpbcheckout")){e.preventDefault(),_(!0);var a,t={},o={shipping_first_name:["shipping_first_name",ajax_var_checkout.shipping_first_name_required_label,/^[a-zA-Z0-9]+$/,"First Name must be letters only"],shipping_last_name:["shipping_last_name",ajax_var_checkout.shipping_last_name_required_label,/^[a-zA-Z0-9]+$/,"Last Name must be letters only"],email_address:["email_address",ajax_var_checkout.email_address_required_label,/^[a-zA-Z0-9+.]+@[a-zA-Z0-9]+\.[a-zA-Z0-9]+$/,"Email must be a valid email"],shipping_address:["shipping_address",ajax_var_checkout.shipping_address_required_label,/^\s*\S+(?:\s+\S+){2}/,"Address must be letters only"],shipping_city:["shipping_city",ajax_var_checkout.shipping_city_required_label,/^[a-zA-Z]+$/,"City must be letters only"],shipping_country:["shipping_country",ajax_var_checkout.shipping_country_required_label,/^[a-zA-Z0-9]+$/,"Country must be letters only"],shipping_postal_code:["shipping_postal_code",ajax_var_checkout.shipping_postal_code_required_label,/^[0-9]+$/,"Postal code must be numerics only"],shipping_phone:["shipping_phone",ajax_var_checkout.shipping_phone_required_label,/^[0-9]+$/,"Phone must be numerics only"],terms:["terms","Terms is required",null,ajax_var_checkout.terms_required_label]};for(a in o){var i=o[a],n=document.getElementById(a),d=document.getElementsByClassName(i[0]+"Error")[0],r=n.value.trim();d.classList.remove("block"),d.classList.add("hidden"),n.classList.remove("border-red-500"),"terms"!==a||n.checked?""===r?t[i[0]]=i[1]:null!==i[2]&&i[2].length&&!r.match(i[2])&&(t[i[0]]=i[3]):t[a]=i[3]}var s,e=document.querySelector('input[name="delivery-method"]:checked');if(e&&(s=document.querySelector('button[data-method-id="'+e.value+'"]'),!document.querySelector('.replacedButton[data-method-id="'+e?.value+'"]'))&&s&&(t.delivery_method=ajax_var_checkout.delivery_method_required_label),0<Object.keys(t).length){for(var c in t){var l=document.getElementById(c),h=document.getElementsByClassName(c+"Error")[0];l&&l.length&&l.classList.add("border-red-500"),h.classList.remove("hidden"),h.classList.add("block"),h.innerHTML=t[c]}_(!1)}else{$thisbutton=p(this),nonce=$thisbutton.data("nonce");e={action:"wpboutik_ajax_create_order",datas:datas=p("#checkout_form").serialize(),nonce:nonce};p.ajax({type:"post",url:ajax_var_checkout.url,data:e,success:function(e){e.success&&("monetico"===e.payment_type?p.ajax({type:"post",url:ajax_var_checkout.url,data:{action:"wpboutik_ajax_create_payment_monetico",order_id:e.order_id,total:e.total,billing_details:e.billing_details,url_ok:e.url,nonce:ajax_var_checkout.nonce_create_payment_monetico},success:function(e){e.success&&(p("body").append(e.form_html),p("#wpbFormMonetico").submit())}}):"paybox"===e.payment_type?p.ajax({type:"post",url:ajax_var_checkout.url,data:{action:"wpboutik_ajax_create_payment_paybox",order_id:e.order_id,billing_details:e.billing_details,total_qty:e.total_qty,total:e.total,nonce:ajax_var_checkout.nonce_create_payment_paybox},success:function(e){e.success&&(p("body").append(e.form_html),p("#wpbFormPaybox").submit())}}):window.location=e.url)}})}}}),p("#checkout_form").change(function(){var e;e={action:"wpboutik_ajax_save_data_checkout",datas:e=p(this).serialize(),nonce:ajax_var_checkout.nonce_save_data_checkout},p.ajax({type:"post",url:ajax_var_checkout.url,data:e,success:function(e){}})})});